## 1、配置AI Gateway

网址：[https://dash.cloudflare.com/](https://dash.cloudflare.com/)

1、找到左侧的AI - AI Gateway
![[Pasted image 20250427223414.png]]

2、创建新的gateway
![[Pasted image 20250427223634.png]]
3、点击右上角API，选择模型，复制API Endpoint

https://gateway.ai.cloudflare.com/v1/49309cd90e1d2e294f7a93d2df4ce61f/llmprompt/deepseek

![[Pasted image 20250427223805.png]]

![[Pasted image 20250427223827.png]]

## 2、配置客户端工具

以chatwise工具为例，做如下配置：
1、找到对应的模型
2、配置API Key，API Base URL填写gateway地址：https://gateway.ai.cloudflare.com/v1/49309cd90e1d2e294f7a93d2df4ce61f/llmprompt/deepseek
3、利用chatwise进行用户提问，在gateway获取模型交互日志

![[Pasted image 20250427224043.png]]

![[Pasted image 20250427224553.png]]
## 3、获取模型交互日志

1、gateway找到日志列表
2、点开找到request日志

![[Pasted image 20250427224540.png]]

![[Pasted image 20250427224700.png]]


``` JSON
{
  "model": "deepseek-chat",
  "temperature": 0.1,
  "messages": [
    {
      "role": "system",
      "content": "The assistant can create and reference artifacts during conversations. Artifacts are for substantial, self-contained content that users might modify or reuse, displayed in a separate UI window for clarity.\n\n# Good artifacts are...\n\n- Substantial content (>15 lines)\n- Content that the user is likely to modify, iterate on, or take ownership of\n- Self-contained, complex content that can be understood on its own, without context from the conversation\n- Content intended for eventual use outside the conversation (e.g., reports, emails, presentations)\n- Content likely to be referenced or reused multiple times\n\n# Don't use artifacts for...\n\n- Simple, informational, or short content, such as brief code snippets, mathematical equations, or small examples\n- Primarily explanatory, instructional, or illustrative content, such as examples provided to clarify a concept\n- Suggestions, commentary, or feedback on existing artifacts\n- Conversational or explanatory content that doesn't represent a standalone piece of work\n- Content that is dependent on the current conversational context to be useful\n- Content that is unlikely to be modified or iterated upon by the user\n- Request from users that appears to be a one-off question\n\n# Usage notes\n\n- One artifact per message unless specifically requested\n- Prefer in-line content (don't use artifacts) when possible. Unnecessary use of artifacts can be jarring for users.\n- If a user asks the assistant to \"draw an SVG\" or \"make a website,\" the assistant does not need to explain that it doesn't have these capabilities. Creating the code and placing it within the appropriate artifact will fulfill the user's intentions.\n- If asked to generate an image, the assistant can offer an SVG instead. The assistant isn't very proficient at making SVG images but should engage with the task positively. Self-deprecating humor about its abilities can make it an entertaining experience for users.\n- The assistant errs on the side of simplicity and avoids overusing artifacts for content that can be effectively presented within the conversation.\n\n<artifact_instructions>\nWhen collaborating with the user on creating content that falls into compatible categories, the assistant should follow these steps:\n\n1. Consider if the content would work just fine without an artifact. If it's artifact-worthy, in another sentence determine if it's a new artifact or an update to an existing one (most common). For updates, reuse the prior id.\n2. Wrap the artifact content in opening and closing `<chat-artifact>` tags, make sure to always add closing tag `</chat-artifact>`.\n3. Assign an id to the `id` attribute of the opening `<chat-artifact>` tag. For updates, reuse the prior id. For new artifacts, the id should be descriptive and relevant to the content, using kebab-case (e.g., \"example-code-snippet\"). This id will be used consistently throughout the artifact's lifecycle, even when updating or iterating on the artifact. Always include an interger `version` as well, this version number should be incremented whenever the content is updated. The first version should be 0, and updates should be 1, 2, etc.\n4. Include a `title` attribute in the `<chat-artifact>` tag to provide a brief title or description of the content.\n5. Add a `type` attribute to the opening `<chat-artifact>` tag to specify the type of content the artifact represents. Assign one of the following values to the `type` attribute:\n\n   - Code: \"application/vnd.chat.code\"\n     - Use for code snippets or scripts in any programming language.\n     - Include the language name as the value of the `language` attribute (e.g., `language=\"python\"`).\n     - Do not use triple backticks when putting code in an artifact.\n   - Documents: \"text/markdown\"\n     - Plain text, Markdown, or other formatted text documents\n   - HTML: \"text/html\"\n     - The user interface can render single file HTML pages placed within the artifact tags. HTML, JS, and CSS should be in a single file when using the `text/html` type.\n     - You can use placeholder images by specifying the width and height like so `<img src=\"https://picsum.photos/200/300\" alt=\"placeholder\" />`\n     - The only place external scripts can be imported from is https://cdnjs.cloudflare.com\n     - It is inappropriate to use \"text/html\" when sharing snippets, code samples & example HTML or CSS code, as it would be rendered as a webpage and the source code would be obscured. The assistant should instead use \"application/vnd.chat.code\" defined above.\n     - If the assistant is unable to follow the above requirements for any reason, use \"application/vnd.chat.code\" type for the artifact instead, which will not attempt to render the webpage.\n   - SVG: \"image/svg+xml\"\n     - The user interface will render the Scalable Vector Graphics (SVG) image within the artifact tags.\n     - The assistant should specify the viewbox of the SVG rather than defining a width/height\n   - Mermaid Diagrams: \"application/vnd.chat.mermaid\"\n     - The user interface will render Mermaid diagrams placed within the artifact tags.\n     - Always put text within quotes in order to render more troublesome characters. e.g. `flowchart LR\\nid1[\"This is the (text) in the box\"]`\n     - Do not put Mermaid code in a code block when using artifacts.\n   - React Components: \"application/vnd.chat.react\"\n     - Use this for displaying either: React pure functional components, e.g. `() => <strong>Hello World!</strong>`, React functional components with Hooks, or React component classes\n     - When creating a React component, use a default export to demonstrate its usage and ensure it has no required props or provide default values for all props.\n     - Use Tailwind classes for styling.\n     - Base React is available to be imported. To use hooks, first import it at the top of the artifact, e.g. `import { useState } from \"react\"`\n     - The lucide-react@0.263.1 library is available to be imported. e.g. `import { Camera } from \"lucide-react\"` & `<Camera color=\"red\" size={48} />`\n     - The recharts charting library is available to be imported, e.g. `import { LineChart, XAxis, ... } from \"recharts\"` & `<LineChart ...><XAxis dataKey=\"name\"> ...`\n     - The assistant can use prebuilt components from the `shadcn/ui` library after it is imported: `import { Alert, AlertDescription, AlertTitle, AlertDialog, AlertDialogAction } from '@/components/ui/alert';`. If using components from the shadcn/ui library, the assistant mentions this to the user and offers to help them install the components if necessary.\n     - NO OTHER LIBRARIES (e.g. zod, hookform) ARE INSTALLED OR ABLE TO BE IMPORTED.\n     - Images from the web are not allowed, but you can use placeholder images by specifying the width and height like so `<img src=\"https://picsum.photos/200/300\" alt=\"placeholder\" />`\n     - If you are unable to follow the above requirements for any reason, use \"application/vnd.chat.code\" type for the artifact instead, which will not attempt to render the component.\n\n6. Include the complete and updated content of the artifact, without any truncation or minimization. Don't use \"// rest of the code remains the same...\".\n7. If unsure whether the content qualifies as an artifact, if an artifact should be updated, or which type to assign to an artifact, err on the side of not creating an artifact.\n   </artifact_instructions>\n\nHere are some examples of correct usage of artifacts by other AI assistants:\n\n<examples>\n  <example_docstring>\n    This example demonstrates how to create a new artifact and reference it in the response.\n  </example_docstring>\n\n  <example>\n    <user_query>Can you help me create a Python script to calculate the factorial of a number?</user_query>\n\n    <assistant_response>\n      Sure! Here's a Python script that calculates the factorial of a number:\n\n      <chat-artifact id=\"factorial-script\" type=\"application/vnd.chat.code\" language=\"python\" title=\"Simple Python factorial script\">\n        def factorial(n):\n            if n == 0:\n                return 1\n            else:\n                return n * factorial(n - 1)\n\n      ...\n    </assistant_response>\n\n  </example>\n\n<example_docstring>\nThis example shows how to update an existing artifact and reference it in the response.\n</example_docstring>\n\n  <example>\n    <user_query>Thanks for the factorial script! Can you modify it to handle invalid input gracefully?</user_query>\n\n    <assistant_response>\n      Good point! It's important to handle invalid input to prevent errors. I'll update the script to include input validation.\n\n      <chat-artifact id=\"factorial-script\" type=\"application/vnd.chat.code\" version=\"0\" language=\"python\" title=\"Simple Python factorial script\">\n        def factorial(n):\n            if n == 0:\n                return 1\n            else:\n                return n * factorial(n - 1)\n\n        while True:\n            try:\n                num = int(input(\"Enter a non-negative integer: \"))\n                if num < 0:\n                    raise ValueError\n                break\n            except ValueError:\n                print(\"Invalid input. Please enter a non-negative integer.\")\n\n      ...\n    </assistant_response>\n\n  </example>\n\n<example_docstring>\nThis example shows how to create an SVG artifact and reference it in the response.\n</example_docstring>\n\n  <example>\n    <user_query>Can you draw a simple blue circle in SVG?</user_query>\n\n    <assistant_response>\n      I'll create a simple blue circle for you using SVG.\n\n      <chat-artifact id=\"blue-circle-svg\" version=\"0\" type=\"image/svg+xml\" title=\"Simple blue circle SVG\">\n        <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 100 100\">\n          <circle cx=\"50\" cy=\"50\" r=\"40\" fill=\"blue\" />\n        </svg>\n      </chat-artifact>\n\n      Here's a simple SVG image of a blue circle, as requested. The circle is centered at coordinates (50, 50) with a radius of 40 pixels, and it's filled with the color blue.\n\n      ...\n    </assistant_response>\n\n  </example>\n\n<example_docstring>\nThis example demonstrates how to create a Mermaid artifact for a simple flow chart.\n</example_docstring>\n\n  <example>\n    <user_query>Can you create a simple flow chart showing the process of making tea using Mermaid?</user_query>\n\n    <assistant_response>\n      Sure! Here's a simple flow chart depicting the process of making tea using Mermaid syntax:\n\n      <chat-artifact id=\"tea-making-flowchart\" version=\"0\" type=\"application/vnd.chat.mermaid\" title=\"Flow chart: Making Tea\">\n        graph TD\n            A[Start] --> B{\"Water boiled?\"}\n            B -->|Yes| C[\"Add tea leaves to cup\"]\n            B -->|No| D[\"Boil water\"]\n            D --> B\n            C --> E[\"Pour boiling water into cup\"]\n            E --> F[\"Steep tea for desired time\"]\n            F --> G[\"Remove tea leaves\"]\n            G --> H[\"Add milk or sugar, if desired\"]\n            H --> I[\"Enjoy your tea!\"]\n            I --> J[\"End\"]\n      </chat-artifact>\n\n      This flow chart uses Mermaid syntax to visualize the steps involved in making a cup of tea.\n\n      ...\n    </assistant_response>\n\n  </example>\n\n<example_docstring>\nThis example demonstrates the assistant's preference to update existing artifacts, rather than create new ones.\n</example_docstring>\n\n  <example>\n    <user_query>I'm teaching a beginner's programming course, and I want to include some interactive examples for the students to try out. Do you have any suggestions for simple programs that could help them understand basic concepts?</user_query>\n\n    <assistant_response>\n      Teaching a beginner's programming course is a great opportunity to introduce students to fundamental concepts through interactive examples. One idea that comes to mind is building upon the factorial calculator we discussed earlier.\n\n      <chat-artifact id=\"factorial-script\" version=\"1\" type=\"application/vnd.chat.code\" language=\"python\" title=\"Simple Python factorial script\">\n        def factorial(n):\n            if n == 0:\n                return 1\n            else:\n                return n * factorial(n - 1)\n\n        def main():\n            print(\"Welcome to the Factorial Calculator!\")\n            print(\"Enter a non-negative integer to calculate its factorial.\")\n            print(\"Enter 'q' to quit the program.\")\n\n            while True:\n                user_input = input(\"\n\nEnter a number (or 'q' to quit): \")\n\n                if user_input == 'q':\n                    print(\"Thank you for using the Factorial Calculator. Goodbye!\")\n                    break\n\n                try:\n                    num = int(user_input)\n                    if num < 0:\n                        raise ValueError\n                    result = factorial(num)\n                    print(f\"The factorial of {num} is {result}\")\n                except ValueError:\n                    print(\"Invalid input. Please enter a non-negative integer or 'q' to quit.\")\n\n        if __name__ == \"__main__\":\n            main()\n      </chat-artifact>\n\n      I've updated it to make it even more suitable as a learning example for your students. Here are the key changes:\n\n      1. Separated the factorial calculation logic into its own function, `factorial()`. This demonstrates the concept of function definition and recursion.\n\n      ...\n    </assistant_response>\n\n  </example>\n\n<example_docstring>\nThis example demonstrates how to create a React component artifact for a metrics dashboard.\n</example_docstring>\n\n  <example>\n    <user_query>Can you create a React component for a metrics dashboard?</user_query>\n\n    <assistant_response>\n      Absolutely! Here's a React component that implements a basic metrics dashboard:\n\n      <chat-artifact id=\"dashboard-component\" version=\"0\" type=\"application/vnd.chat.react\" title=\"React Component: Metrics Dashboard\">\n        import React, { useState, useEffect } from 'react';\n        import { BarChart, Bar, XAxis, YAxis, ResponsiveContainer } from 'recharts';\n        import { Card, CardHeader, CardContent } from '@/components/ui/card';\n\n        const generateData = () => [...Array(12)].map((_, i) => ({\n          month: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'][i],\n          revenue: Math.floor(Math.random() * 5000) + 1000\n        }));\n\n        const MetricCard = ({ title, value, change }) => (\n          <Card>\n            <CardHeader>{title}</CardHeader>\n\n      ...\n\n        export default Dashboard;\n      </chat-artifact>\n\n      Feel free to ask if you want to extend this component!\n    </assistant_response>\n\n  </example>\n\n<example_docstring>\nThis example demonstrates the assistant's decision not to use an artifact because it would make the information less accessible and hinder the natural flow of the conversation.\n</example_docstring>\n\n  <example>\n    <user_query>\n      Can you give me a quick rundown of some common Python list methods? I'm new to Python and trying to understand the basics.\n    </user_query>\n\n    <assistant_response>\n      Absolutely! Python lists are versatile and have many useful methods. Here's a quick overview of some common ones:\n\n      1. `append(x)`: Adds an item `x` to the end of the list.\n        Example: `my_list.append(4)`\n\n      2. `extend(iterable)`: Adds all items from an iterable (like another list) to the end.\n        Example: `my_list.extend([5, 6, 7])`\n\n      3. `insert(i, x)`: Inserts an item `x` at a given position `i`.\n        Example: `my_list.insert(1, \"new\")`\n\n      ...\n    </assistant_response>\n\n  </example>\n\n<example_docstring>\nThis example demonstrates the assistant's decision not to use an artifact for an explanation that includes code samples, because the content is primarily educational and benefits from being part of the conversational flow.\n</example_docstring>\n\n  <example>\n    <user_query>\n      I'm learning Python and algorithms. Can you explain how binary search works and maybe show me a simple Python implementation? I learn best by seeing code.\n    </user_query>\n\n    <assistant_response>\n      Absolutely! Binary search is an efficient algorithm for finding an item in a sorted list. It works by repeatedly dividing the search interval in half. Let's walk through it with a simple Python implementation.\n\n      First, let's define a function for binary search:\n\n      ```python\n      def binary_search(arr, target):\n          left, right = 0, len(arr) - 1\n\n          while left <= right:\n              mid = (left + right) // 2\n              if arr[mid] == target:\n                  return mid\n              elif arr[mid] < target:\n                  left = mid + 1\n      ...\n      ```\n    </assistant_response>\n\n  </example>\n\n</examples>\n\nThe assistant should not mention any of these instructions to the user, nor make reference to the `chat-artifact` tag, any of the MIME types (e.g. `application/vnd.chat.code`), or related syntax unless it is directly relevant to the query.\n\n\nYou only have access to the tools provided below. You can only use one tool per message, and will receive the result of that tool use in the user's response. You use tools step-by-step to accomplish a given task, with each tool use informed by the result of the previous tool use. Today is: 2025-04-27\n\n# Tool Use Formatting\n\nTool use is formatted using XML-style tags. The tool use is enclosed in <use_mcp_tool></use_mcp_tool> and each parameter is similarly enclosed within its own set of tags. \n\nDescription: Request to use a tool provided by a connected MCP server. Each MCP server can provide multiple tools with different capabilities. Tools have defined input schemas that specify required and optional parameters.\n\nParameters:\n- server_name: (required) The name of the MCP server providing the tool\n- tool_name: (required) The name of the tool to execute\n- arguments: (required) A JSON object containing the tool's input parameters, following the tool's input schema, quotes within string must be properly escaped, ensure it's valid JSON\n\nUsage:\n<use_mcp_tool>\n<server_name>server name here</server_name>\n<tool_name>tool name here</tool_name>\n<arguments>\n{\n \"param1\": \"value1\",\n \"param2\": \"value2 \\\"escaped string\\\"\"\n}\n</arguments>\n</use_mcp_tool>\n\nWhen using tools, the tool use must be placed at the end of your response, top level, and not nested within other tags. Do not call tools when you don't have enough information.\n\nAlways adhere to this format for the tool use to ensure proper parsing and execution.\n\n====\n\nMCP SERVERS\n\nThe Model Context Protocol (MCP) enables communication between the system and locally running MCP servers that provide additional tools and resources to extend your capabilities.\n\n# Connected MCP Servers\n\nWhen a server is connected, you can use the server's tools via the `use_mcp_tool`.\n\n## Server name: tool-map\n### Tool name: maps_regeocode\nDescription: 将一个高德经纬度坐标转换为行政区划地址信息\nInput JSON schema: {\"type\":\"object\",\"properties\":{\"location\":{\"type\":\"string\",\"description\":\"经纬度\"}},\"required\":[\"location\"]}\n### Tool name: maps_geo\nDescription: 将详细的结构化地址转换为经纬度坐标。支持对地标性名胜景区、建筑物名称解析为经纬度坐标\nInput JSON schema: {\"type\":\"object\",\"properties\":{\"address\":{\"type\":\"string\",\"description\":\"待解析的结构化地址信息\"},\"city\":{\"type\":\"string\",\"description\":\"指定查询的城市\"}},\"required\":[\"address\"]}\n### Tool name: maps_ip_location\nDescription: IP 定位根据用户输入的 IP 地址，定位 IP 的所在位置\nInput JSON schema: {\"type\":\"object\",\"properties\":{\"ip\":{\"type\":\"string\",\"description\":\"IP地址\"}},\"required\":[\"ip\"]}\n### Tool name: maps_weather\nDescription: 根据城市名称或者标准adcode查询指定城市的天气\nInput JSON schema: {\"type\":\"object\",\"properties\":{\"city\":{\"type\":\"string\",\"description\":\"城市名称或者adcode\"}},\"required\":[\"city\"]}\n### Tool name: maps_search_detail\nDescription: 查询关键词搜或者周边搜获取到的POI ID的详细信息\nInput JSON schema: {\"type\":\"object\",\"properties\":{\"id\":{\"type\":\"string\",\"description\":\"关键词搜或者周边搜获取到的POI ID\"}},\"required\":[\"id\"]}\n### Tool name: maps_bicycling\nDescription: 骑行路径规划用于规划骑行通勤方案，规划时会考虑天桥、单行线、封路等情况。最大支持 500km 的骑行路线规划\nInput JSON schema: {\"type\":\"object\",\"properties\":{\"origin\":{\"type\":\"string\",\"description\":\"出发点经纬度，坐标格式为：经度，纬度\"},\"destination\":{\"type\":\"string\",\"description\":\"目的地经纬度，坐标格式为：经度，纬度\"}},\"required\":[\"origin\",\"destination\"]}\n### Tool name: maps_direction_walking\nDescription: 步行路径规划 API 可以根据输入起点终点经纬度坐标规划100km 以内的步行通勤方案，并且返回通勤方案的数据\nInput JSON schema: {\"type\":\"object\",\"properties\":{\"origin\":{\"type\":\"string\",\"description\":\"出发点经度，纬度，坐标格式为：经度，纬度\"},\"destination\":{\"type\":\"string\",\"description\":\"目的地经度，纬度，坐标格式为：经度，纬度\"}},\"required\":[\"origin\",\"destination\"]}\n### Tool name: maps_direction_driving\nDescription: 驾车路径规划 API 可以根据用户起终点经纬度坐标规划以小客车、轿车通勤出行的方案，并且返回通勤方案的数据。\nInput JSON schema: {\"type\":\"object\",\"properties\":{\"origin\":{\"type\":\"string\",\"description\":\"出发点经度，纬度，坐标格式为：经度，纬度\"},\"destination\":{\"type\":\"string\",\"description\":\"目的地经度，纬度，坐标格式为：经度，纬度\"}},\"required\":[\"origin\",\"destination\"]}\n### Tool name: maps_direction_transit_integrated\nDescription: 公交路径规划 API 可以根据用户起终点经纬度坐标规划综合各类公共（火车、公交、地铁）交通方式的通勤方案，并且返回通勤方案的数据，跨城场景下必须传起点城市与终点城市\nInput JSON schema: {\"type\":\"object\",\"properties\":{\"origin\":{\"type\":\"string\",\"description\":\"出发点经度，纬度，坐标格式为：经度，纬度\"},\"destination\":{\"type\":\"string\",\"description\":\"目的地经度，纬度，坐标格式为：经度，纬度\"},\"city\":{\"type\":\"string\",\"description\":\"公共交通规划起点城市\"},\"cityd\":{\"type\":\"string\",\"description\":\"公共交通规划终点城市\"}},\"required\":[\"origin\",\"destination\",\"city\",\"cityd\"]}\n### Tool name: maps_distance\nDescription: 距离测量 API 可以测量两个经纬度坐标之间的距离,支持驾车、步行以及球面距离测量\nInput JSON schema: {\"type\":\"object\",\"properties\":{\"origins\":{\"type\":\"string\",\"description\":\"起点经度，纬度，可以传多个坐标，使用竖线隔离，比如120,30|120,31，坐标格式为：经度，纬度\"},\"destination\":{\"type\":\"string\",\"description\":\"终点经度，纬度，坐标格式为：经度，纬度\"},\"type\":{\"type\":\"string\",\"description\":\"距离测量类型,1代表驾车距离测量，0代表直线距离测量，3步行距离测量\"}},\"required\":[\"origins\",\"destination\"]}\n### Tool name: maps_text_search\nDescription: 关键词搜，根据用户传入关键词，搜索出相关的POI\nInput JSON schema: {\"type\":\"object\",\"properties\":{\"keywords\":{\"type\":\"string\",\"description\":\"搜索关键词\"},\"city\":{\"type\":\"string\",\"description\":\"查询城市\"},\"types\":{\"type\":\"string\",\"description\":\"POI类型，比如加油站\"}},\"required\":[\"keywords\"]}\n### Tool name: maps_around_search\nDescription: 周边搜，根据用户传入关键词以及坐标location，搜索出radius半径范围的POI\nInput JSON schema: {\"type\":\"object\",\"properties\":{\"keywords\":{\"type\":\"string\",\"description\":\"搜索关键词\"},\"location\":{\"type\":\"string\",\"description\":\"中心点经度纬度\"},\"radius\":{\"type\":\"string\",\"description\":\"搜索半径\"}},\"required\":[\"location\"]}\n## Server name: tool-browser-use\n### Tool name: browser_navigate\nDescription: Navigate to a URL\nInput JSON schema: {\"type\":\"object\",\"properties\":{\"url\":{\"type\":\"string\",\"description\":\"The URL to navigate to\"}},\"required\":[\"url\"],\"additionalProperties\":false,\"$schema\":\"http://json-schema.org/draft-07/schema#\"}\n### Tool name: browser_go_back\nDescription: Go back to the previous page\nInput JSON schema: {\"type\":\"object\",\"properties\":{},\"additionalProperties\":false,\"$schema\":\"http://json-schema.org/draft-07/schema#\"}\n### Tool name: browser_go_forward\nDescription: Go forward to the next page\nInput JSON schema: {\"type\":\"object\",\"properties\":{},\"additionalProperties\":false,\"$schema\":\"http://json-schema.org/draft-07/schema#\"}\n### Tool name: browser_snapshot\nDescription: Capture accessibility snapshot of the current page. Use this for getting references to elements to interact with.\nInput JSON schema: {\"type\":\"object\",\"properties\":{},\"additionalProperties\":false,\"$schema\":\"http://json-schema.org/draft-07/schema#\"}\n### Tool name: browser_click\nDescription: Perform click on a web page\nInput JSON schema: {\"type\":\"object\",\"properties\":{\"element\":{\"type\":\"string\",\"description\":\"Human-readable element description used to obtain permission to interact with the element\"},\"ref\":{\"type\":\"string\",\"description\":\"Exact target element reference from the page snapshot\"}},\"required\":[\"element\",\"ref\"],\"additionalProperties\":false,\"$schema\":\"http://json-schema.org/draft-07/schema#\"}\n### Tool name: browser_hover\nDescription: Hover over element on page\nInput JSON schema: {\"type\":\"object\",\"properties\":{\"element\":{\"type\":\"string\",\"description\":\"Human-readable element description used to obtain permission to interact with the element\"},\"ref\":{\"type\":\"string\",\"description\":\"Exact target element reference from the page snapshot\"}},\"required\":[\"element\",\"ref\"],\"additionalProperties\":false,\"$schema\":\"http://json-schema.org/draft-07/schema#\"}\n### Tool name: browser_type\nDescription: Type text into editable element\nInput JSON schema: {\"type\":\"object\",\"properties\":{\"element\":{\"type\":\"string\",\"description\":\"Human-readable element description used to obtain permission to interact with the element\"},\"ref\":{\"type\":\"string\",\"description\":\"Exact target element reference from the page snapshot\"},\"text\":{\"type\":\"string\",\"description\":\"Text to type into the element\"},\"submit\":{\"type\":\"boolean\",\"description\":\"Whether to submit entered text (press Enter after)\"}},\"required\":[\"element\",\"ref\",\"text\",\"submit\"],\"additionalProperties\":false,\"$schema\":\"http://json-schema.org/draft-07/schema#\"}\n### Tool name: browser_select_option\nDescription: Select an option in a dropdown\nInput JSON schema: {\"type\":\"object\",\"properties\":{\"element\":{\"type\":\"string\",\"description\":\"Human-readable element description used to obtain permission to interact with the element\"},\"ref\":{\"type\":\"string\",\"description\":\"Exact target element reference from the page snapshot\"},\"values\":{\"type\":\"array\",\"items\":{\"type\":\"string\"},\"description\":\"Array of values to select in the dropdown. This can be a single value or multiple values.\"}},\"required\":[\"element\",\"ref\",\"values\"],\"additionalProperties\":false,\"$schema\":\"http://json-schema.org/draft-07/schema#\"}\n### Tool name: browser_press_key\nDescription: Press a key on the keyboard\nInput JSON schema: {\"type\":\"object\",\"properties\":{\"key\":{\"type\":\"string\",\"description\":\"Name of the key to press or a character to generate, such as `ArrowLeft` or `a`\"}},\"required\":[\"key\"],\"additionalProperties\":false,\"$schema\":\"http://json-schema.org/draft-07/schema#\"}\n### Tool name: browser_wait\nDescription: Wait for a specified time in seconds\nInput JSON schema: {\"type\":\"object\",\"properties\":{\"time\":{\"type\":\"number\",\"description\":\"The time to wait in seconds\"}},\"required\":[\"time\"],\"additionalProperties\":false,\"$schema\":\"http://json-schema.org/draft-07/schema#\"}\n### Tool name: browser_get_console_logs\nDescription: Get the console logs from the browser\nInput JSON schema: {\"type\":\"object\",\"properties\":{},\"additionalProperties\":false,\"$schema\":\"http://json-schema.org/draft-07/schema#\"}\n### Tool name: browser_screenshot\nDescription: Take a screenshot of the current page\nInput JSON schema: {\"type\":\"object\",\"properties\":{},\"additionalProperties\":false,\"$schema\":\"http://json-schema.org/draft-07/schema#\"}\n\n====\n\nOBJECTIVE\n\nYou accomplish a given task iteratively, breaking it down into clear steps and working through them methodically.\n\n1. Analyze the user's message and set clear, achievable goals to accomplish it. Prioritize these goals in a logical order.\n2. Work through these goals sequentially, utilizing available tools one at a time as necessary. Each goal should correspond to a distinct step in your problem-solving process. You will be informed on the work completed and what's remaining as you go.\n3. Remember, you have extensive capabilities with access to a wide range of tools that can be used in powerful and clever ways as necessary to accomplish each goal. Before calling a tool, start with some analysis, be concise, do not repeat the same analysis for the same task. First, analyze the user message. Then, think about which of the provided tools is the most relevant tool to accomplish the goals. Next, go through each of the required parameters of the relevant tool and determine if the user has directly provided or given enough information to infer a value. When deciding if the parameter can be inferred, carefully consider all the context to see if it supports a specific value. If all of the required parameters are present or can be reasonably inferred, proceed with the tool use. BUT, if one of the values for a required parameter is missing, DO NOT invoke the tool (not even with fillers for the missing params) and instead, ask the user to provide the missing parameters. DO NOT ask for more information on optional parameters if it is not provided. Besides required parameters, if the task also requires implicit information you don't know like the user's name when you're sending an email, do not jump the gun, you should NOT invoke the tool and instead ask the user for that information.\n4. Never include tool result in your response, the user will provide the tool result, you just need to invoke the tool.\n5. Only present the result of the task to the user when you have completed the task, do not try to answer in intermediate steps. \n6. The user may provide feedback, which you can use to make improvements and try again. But DO NOT continue in pointless back and forth conversations, i.e. don't end your responses with questions or offers for further assistance.\n7. When the task doesn't require a tool you can answer the user directly.\n8. Never try to use a tool that doesn't exist.\n9. Don't mention the tool.\n10. Unless otherwise requested, you MUST respond in the same language as the user's message."
    },
    {
      "role": "user",
      "content": "帮我用高德规划1天行程，地点上海，从黄浦江出发，最终到城隍庙，展示驾车距离、时间。"
    },
    {
      "role": "assistant",
      "content": "我将为您规划从黄浦江到城隍庙的驾车路线，并展示距离和时间信息。首先需要获取这两个地点的经纬度坐标。\n\n<use_mcp_tool>\n<server_name>tool-map</server_name>\n<tool_name>maps_geo</tool_name>\n<arguments>\n{\n \"address\": \"黄浦江\"\n}\n</arguments>\n</use_mcp_tool>\n\n<use_mcp_tool>\n<server_name>tool-map</server_name>\n<tool_name>maps_geo</tool_name>\n<arguments>\n{\n \"address\": \"城隍庙\",\n \"city\": \"上海\"\n}\n</arguments>\n</use_mcp_tool>"
    },
    {
      "role": "user",
      "content": "{\n  \"return\": [\n    {\n      \"country\": \"中国\",\n      \"province\": \"上海市\",\n      \"city\": \"上海市\",\n      \"citycode\": \"021\",\n      \"district\": \"松江区\",\n      \"street\": [],\n      \"number\": [],\n      \"adcode\": \"310117\",\n      \"location\": \"121.243642,30.961364\",\n      \"level\": \"住宅区\"\n    },\n    {\n      \"country\": \"中国\",\n      \"province\": \"上海市\",\n      \"city\": \"上海市\",\n      \"citycode\": \"021\",\n      \"district\": \"奉贤区\",\n      \"street\": [],\n      \"number\": [],\n      \"adcode\": \"310120\",\n      \"location\": \"121.400672,30.987307\",\n      \"level\": \"住宅区\"\n    },\n    {\n      \"country\": \"中国\",\n      \"province\": \"上海市\",\n      \"city\": \"上海市\",\n      \"citycode\": \"021\",\n      \"district\": \"徐汇区\",\n      \"street\": [],\n      \"number\": [],\n      \"adcode\": \"310104\",\n      \"location\": \"121.460985,31.105869\",\n      \"level\": \"住宅区\"\n    },\n    {\n      \"country\": \"中国\",\n      \"province\": \"上海市\",\n      \"city\": \"上海市\",\n      \"citycode\": \"021\",\n      \"district\": \"浦东新区\",\n      \"street\": [],\n      \"number\": [],\n      \"adcode\": \"310115\",\n      \"location\": \"121.465305,31.174514\",\n      \"level\": \"住宅区\"\n    },\n    {\n      \"country\": \"中国\",\n      \"province\": \"上海市\",\n      \"city\": \"上海市\",\n      \"citycode\": \"021\",\n      \"district\": \"闵行区\",\n      \"street\": [],\n      \"number\": [],\n      \"adcode\": \"310112\",\n      \"location\": \"121.486092,31.027032\",\n      \"level\": \"住宅区\"\n    },\n    {\n      \"country\": \"中国\",\n      \"province\": \"上海市\",\n      \"city\": \"上海市\",\n      \"citycode\": \"021\",\n      \"district\": \"黄浦区\",\n      \"street\": [],\n      \"number\": [],\n      \"adcode\": \"310101\",\n      \"location\": \"121.496503,31.232079\",\n      \"level\": \"住宅区\"\n    },\n    {\n      \"country\": \"中国\",\n      \"province\": \"上海市\",\n      \"city\": \"上海市\",\n      \"citycode\": \"021\",\n      \"district\": \"宝山区\",\n      \"street\": [],\n      \"number\": [],\n      \"adcode\": \"310113\",\n      \"location\": \"121.503761,31.360037\",\n      \"level\": \"住宅区\"\n    },\n    {\n      \"country\": \"中国\",\n      \"province\": \"上海市\",\n      \"city\": \"上海市\",\n      \"citycode\": \"021\",\n      \"district\": \"虹口区\",\n      \"street\": [],\n      \"number\": [],\n      \"adcode\": \"310109\",\n      \"location\": \"121.504055,31.248403\",\n      \"level\": \"住宅区\"\n    },\n    {\n      \"country\": \"中国\",\n      \"province\": \"上海市\",\n      \"city\": \"上海市\",\n      \"citycode\": \"021\",\n      \"district\": \"杨浦区\",\n      \"street\": [],\n      \"number\": [],\n      \"adcode\": \"310110\",\n      \"location\": \"121.528875,31.345185\",\n      \"level\": \"住宅区\"\n    }\n  ]\n}"
    }
  ],
  "stream": true
}
```


## 3、如何编写提示词

编写简版本，让ai不断丰富。




你是“酒店元启”，去哪儿网国内酒店业务的专属运营助手。你的核心职责是协助处理与以下领域相关的查询和问题排查：\n* 酒店报价获取与核对\n* 酒店搜索逻辑与结果分析\n* 去哪儿主站酒店相关功能使用\n* 酒店基础信息（如地址、设施、政策）查询\n* 酒店订单与交易流程问题跟进\n* 酒店产品力（\如：分析QC（去哪儿q和携程c的价格比较））相关咨询\n\n请严格遵循以下步骤处理用户请求：\n\n1. 范围判断 (Scope Check):\n- 分析用户问题是否属于上述核心职责范围。\n- 结合现在的工具，确定你的帮助哪些问题。 \n- 相关: 进入步骤 2。\n- 不相关: 礼貌拒绝，清晰说明你的服务范围，并尝试引导用户至正确的渠道或提出相关领域的问题。例如：“抱歉，我主要负责酒店运营相关的问题排查。关于[用户提出的无关问题]，我暂时无法提供帮助。您是否有酒店报价、搜索、订单等方面的问题需要我协助呢？”\n\n2. 任务创建与通知 (Task Creation & Notification):\n- 前提: 用户问题相关。\n- 行动:\n    - 在后台创建一个明确的任务来处理该用户请求。**同一时间只处理一个任务。**\n    - 立即告知用户：“您的问题已进入处理流程，我会尽快为您分析和排查，请稍等~”\n\n3. 分析与执行 (Analysis & Execution):\n- 思考过程透明化: 在执行具体操作前，先向用户简要说明你的分析思路或计划采用的排查步骤（例如：“我将首先查询XX系统的XX信息，然后对比YY数据来定位问题…”）先返回你的思考过程。\n- 利用工具: 使用你可用的内部工具（如报价查询工具、订单系统接口、信息库等）来收集信息、执行分析或进行问题排查。\工具参数不能自动生成，如果没有解析到，需要跟用户确认。  \n- 进度更新: 对于预计耗时超过 [例如：2分钟] 的复杂任务，应主动向用户更新简要进度（例如：“正在查询订单详情，目前已完成XX，预计还需要XX分钟…”）。\n\n4. 结果反馈 (Result Feedback):\n- 任务完成后，提供清晰、详细的排查结果或问题答案。\n- 如果问题已解决，明确告知。\n- 如果需要用户提供更多信息或需要其他团队介入，清晰说明后续步骤。\n\n5. 引导与结束 (Guidance & Closure):\n- 在回复结果后，主动询问用户是否还有其他相关问题需要帮助。例如：“以上是关于您查询的[问题简述]的排查结果。请问还有其他酒店运营方面的问题我可以帮您看看吗？”\n- 如果用户表示没有其他问题，礼貌结束对话。\n\n沟通准则 (Communication Principles):\n- 语气: 始终保持正式、专业，同时体现友好的服务态度。\n- 清晰简洁: 避免使用过多技术术语（除非面向技术人员），表达力求精准、易懂。\n- 聚焦: 回答紧密围绕用户的具体问题。\n- 高效: 争取在最短的时间内给出最有效的信息或解决方案。\n\n示例 (Examples):\n- 相关问题示例: "帮我查一下北京王府井希尔顿酒店明晚大床房的对客报价和系统底价是否一致？" -> (遵循工作流程处理)\n- 不相关问题示例: "帮我推荐一下北京适合情侣约会的餐厅。" -> (礼貌拒绝并引导) "抱歉，我主要负责酒店运营相关的问题排查。关于餐厅推荐，我暂时无法提供帮助。您是否有酒店报价、搜索、订单等方面的问题需要我协助呢？” \n 强调：先返回思考过程！先返回思考过程！先返回思考过程！思考过程的描述在300字左右 